import asyncio
import csv
import os
from playwright.async_api import async_playwright

LIST = ['https://www.facebook.com/LinnkAcademyIndia/', 'https://www.facebook.com/MARSCHPAT/', 'https://www.facebook.com/MAX-Computer-Education-Typewriting-Institution-269496956246362/', 'https://www.facebook.com/MAZGlobal/', 'https://www.facebook.com/MAiiB-Edcare-INDIA-Private-Limited-182724831588929/', 'https://www.facebook.com/MGUinnovation2022/', 'https://www.facebook.com/MYRABusinessSchool/', 'https://www.facebook.com/MadAboutParties.MAP/', 'https://www.facebook.com/MadhavAgriTech/', 'https://www.facebook.com/Madhyapardesh.StarAgriseeds/', 'https://www.facebook.com/Mahin-Nasar-104073072587943/', 'https://www.facebook.com/MamunGlobal/', 'https://www.facebook.com/ManappuramFinanceLimitedMAFIL/', 'https://www.facebook.com/ManiFincart/', 'https://www.facebook.com/Mapidstudy/', 'https://www.facebook.com/MapleBearSchoolsIndia/', 'https://www.facebook.com/MargErpLtd/', 'https://www.facebook.com/MargIFS/', 'https://www.facebook.com/Marshharrierin/', 'https://www.facebook.com/Maryamleatherproducts/', 'https://www.facebook.com/McKinsey/', 'https://www.facebook.com/MediaioOfficial/', 'https://www.facebook.com/Milas.Realty/', 'https://www.facebook.com/Mirzassofttech/', 'https://www.facebook.com/MoxyBengaluruAirport/', 'https://www.facebook.com/MyClothingTreasure/', 'https://www.facebook.com/MyFinanceBazaar/', 'https://www.facebook.com/MyPlanetSpark/', 'https://www.facebook.com/MyVirtualMission/', 'https://www.facebook.com/Mymart.Pakistan/', 'https://www.facebook.com/Myonline360/', 'https://www.facebook.com/N-S-CROP-SCIENCE-IMPORT-EXPORT-COMPANY-INDORE-461838253685867/', 'https://www.facebook.com/NIMSUniv/', 'https://www.facebook.com/NITnielitTallyGST/', 'https://www.facebook.com/Nanu-Rohit-151886331339368/', 'https://www.facebook.com/NarrateIndia/', 'https://www.facebook.com/NavkisGokula/', 'https://www.facebook.com/NazDumanskyy/', 'https://www.facebook.com/Nextbigbox/', 'https://www.facebook.com/NipponIndiaMF/', 'https://www.facebook.com/NovelsagoEn/', 'https://www.facebook.com/ORCHIDSTheInternationalSchool/', 'https://www.facebook.com/OneClix-467716789760128/', 'https://www.facebook.com/OptimumFinancialServices24/', 'https://www.facebook.com/Option1Live/', 'https://www.facebook.com/Optispect/', 'https://www.facebook.com/PATHIK2589/', 'https://www.facebook.com/PERI/', 'https://www.facebook.com/PaaramiDigitalConsulting/', 'https://www.facebook.com/PalestraMN/', 'https://www.facebook.com/Pansuriya-Pradip-548348328372102/', 'https://www.facebook.com/PapayaGlobalPayments/', 'https://www.facebook.com/PartnerKanchan/', 'https://www.facebook.com/ParulUniversity/', 'https://www.facebook.com/Pay4Biz/', 'https://www.facebook.com/PeopleMatters/', 'https://www.facebook.com/PerAnnumHQ/', 'https://www.facebook.com/Pixel-Dreams-337219396145255/', 'https://www.facebook.com/Pocketful.HQ/', 'https://www.facebook.com/PracticalPublicSpeakingAdvisor/', 'https://www.facebook.com/PragatiInternationalKota/', 'https://www.facebook.com/Premiumresidenceslucknow/', 'https://www.facebook.com/PriyaTravls/', 'https://www.facebook.com/Priyadarshani-Wadkar-528353760368535/', 'https://www.facebook.com/Publicfigure0007/', 'https://www.facebook.com/PurespoonWellness/', 'https://www.facebook.com/QuantexaSolutions/', 'https://www.facebook.com/Querysurge/', 'https://www.facebook.com/QuikCareComputerServices/', 'https://www.facebook.com/RAYAgriConsulting/', 'https://www.facebook.com/REALDONZUBI/', 'https://www.facebook.com/RKMVidyamandira/', 'https://www.facebook.com/RMAElevates/', 'https://www.facebook.com/Raghavfoundation/', 'https://www.facebook.com/RamaUniversityOfficial/', 'https://www.facebook.com/RanjeetRajOfficial/', 'https://www.facebook.com/Readymadewala.in/', 'https://www.facebook.com/RealJackHibbs/', 'https://www.facebook.com/RealityhubPP/', 'https://www.facebook.com/Recharge-software-477161312139216/', 'https://www.facebook.com/Redisinc/', 'https://www.facebook.com/Resume-no1-458702400652291/', 'https://www.facebook.com/Reverseyourpsoriasis/', 'https://www.facebook.com/RiseInstituteMum/', 'https://www.facebook.com/RiseOppAgency/', 'https://www.facebook.com/Rishi-Gupta-421329097729555/', 'https://www.facebook.com/RituBihaniAgarwal/', 'https://www.facebook.com/RoyalHomeoSpecilalityCenter/', 'https://www.facebook.com/RubrikInc/', 'https://www.facebook.com/SLBCMain/', 'https://www.facebook.com/SPRoboticWorks/', 'https://www.facebook.com/SRIHER.Official/', 'https://www.facebook.com/SaasRise/', 'https://www.facebook.com/Sachin-Khatri-643594788826918/', 'https://www.facebook.com/SakshiChandraakar/', 'https://www.facebook.com/Saleskido/', 'https://www.facebook.com/SanhitaPhotography/', 'https://www.facebook.com/SanketThakreFitness/', 'https://www.facebook.com/SanskaramUniversity/', 'https://www.facebook.com/SatyamJewelers/', 'https://www.facebook.com/Serenityartnhome/', 'https://www.facebook.com/Shivshakti-Agritech-552500387947763/', 'https://www.facebook.com/ShriBGGaraiyaHospital/', 'https://www.facebook.com/Shubhra.coach/', 'https://www.facebook.com/SkillBlazeAI/', 'https://www.facebook.com/SkillDeckforTrainings/', 'https://www.facebook.com/Skillshalaa/', 'https://www.facebook.com/SkyTrix251/', 'https://www.facebook.com/SmartistU/', 'https://www.facebook.com/SmoothRobotics/', 'https://www.facebook.com/Socialite.official/', 'https://www.facebook.com/SoftenTechnologies/', 'https://www.facebook.com/SoftwareSuggest/', 'https://www.facebook.com/Somnath-Sakhare-103272891868749/', 'https://www.facebook.com/SpalbaHQ/', 'https://www.facebook.com/SprinklerAgriculturalEquipment/', 'https://www.facebook.com/Sshekars-Insurance-Advisory-510014692192408/', 'https://www.facebook.com/StartYourSaaS.io/', 'https://www.facebook.com/Surekhasoftware/', 'https://www.facebook.com/SureshDrives/', 'https://www.facebook.com/SusanIdentityProperties/', 'https://www.facebook.com/SwanProperties.Cochin/', 'https://www.facebook.com/Swapnil-Pawar-Patil-104020805218007/', 'https://www.facebook.com/Synergetics.Learning/', 'https://www.facebook.com/TEKNOVATESOLUTION/', 'https://www.facebook.com/THELIFElivelong/', 'https://www.facebook.com/TMCmobileTechnology/', 'https://www.facebook.com/TPIPAY-FINTECH-PRIVATE-LIMITED-175840675611388/', 'https://www.facebook.com/TVSElectronics/', 'https://www.facebook.com/TableSpaceOfficial/', 'https://www.facebook.com/TanweerSidd.01/', 'https://www.facebook.com/TaxYaari/', 'https://www.facebook.com/TdotKPakistan/', 'https://www.facebook.com/Teachers-Training-Academy-166195713239968/', 'https://www.facebook.com/TechVansh/', 'https://www.facebook.com/Techjockey/', 'https://www.facebook.com/Techxpert.in/', 'https://www.facebook.com/TeflasEvents/', 'https://www.facebook.com/TheBlackSPS/', 'https://www.facebook.com/TheCapra/', 'https://www.facebook.com/TheDataLabs/', 'https://www.facebook.com/TheJerusalemPost/', 'https://www.facebook.com/TheMikeMonday/', 'https://www.facebook.com/TheNice0ffice/', 'https://www.facebook.com/Thebarcollect/', 'https://www.facebook.com/Thekreativepixelz/', 'https://www.facebook.com/ThinkAheadWithAI.TAWAI/', 'https://www.facebook.com/ThunderbirdSchool/', 'https://www.facebook.com/Trainedbykuldeepsinghyadav/', 'https://www.facebook.com/TrainingTilt/', 'https://www.facebook.com/TrifectaProjects/', 'https://www.facebook.com/Tripoto/', 'https://www.facebook.com/Tronsoftech/', 'https://www.facebook.com/TrucksUpApp/', 'https://www.facebook.com/UCAM.International/', 'https://www.facebook.com/UniversalInfratechIndore/', 'https://www.facebook.com/UniversalSkilltechUniversity/', 'https://www.facebook.com/UofGlasgow/', 'https://www.facebook.com/UrbanriseOncloud33/', 'https://www.facebook.com/Urjajewels/', 'https://www.facebook.com/VIDYADAN-CLASSES-100676629723319/', 'https://www.facebook.com/VISHWANATH-CHESS-ACADEMY-670728392779707/', 'https://www.facebook.com/ValeriVisuals/', 'https://www.facebook.com/VeeamSoftware/', 'https://www.facebook.com/VentureCareIndia/', 'https://www.facebook.com/Vetqure/', 'https://www.facebook.com/Vetrivel-Moorthy-102191111636113/', 'https://www.facebook.com/Vijay-Health-Fitness-Centar-497660046763731/', 'https://www.facebook.com/VishnuRacingMotors1/', 'https://www.facebook.com/VivekCollegeBijnor/', 'https://www.facebook.com/VoiceTree/', 'https://www.facebook.com/Vriksham/', 'https://www.facebook.com/Wasiff-Gaming-424010690800030/', 'https://www.facebook.com/WeAreMaxio/', 'https://www.facebook.com/WebTecz/', 'https://www.facebook.com/WebToraTech/', 'https://www.facebook.com/WesternSpeakerOfficial/', 'https://www.facebook.com/Willconic-546210698570938/', 'https://www.facebook.com/WirtgenGroup/', 'https://www.facebook.com/WishInfinitePage/', 'https://www.facebook.com/Xgenplusemail/', 'https://www.facebook.com/YCTCBelghoria/', 'https://www.facebook.com/YESTE.Migration.Education.Consulting/', 'https://www.facebook.com/Yaariyanholidays/', 'https://www.facebook.com/YogaFarmIthaca/', 'https://www.facebook.com/YouthIncMag/', 'https://www.facebook.com/Zenzap.messaging/', 'https://www.facebook.com/aafm.in/', 'https://www.facebook.com/aasaanerp/', 'https://www.facebook.com/academicheightspublicschoolbhosari/', 'https://www.facebook.com/accutecherp/', 'https://www.facebook.com/accuwisetechdelhi/', 'https://www.facebook.com/acesheets1/', 'https://www.facebook.com/adhyyanonline/', 'https://www.facebook.com/admisssiontoday/', 'https://www.facebook.com/aeronpay/', 'https://www.facebook.com/aesquare.immigration.services/', 'https://www.facebook.com/agilelix/', 'https://www.facebook.com/agri.nkosh/', 'https://www.facebook.com/agriintexcodissia/', 'https://www.facebook.com/agrikheti/', 'https://www.facebook.com/agritech.international/', 'https://www.facebook.com/agriwow/', 'https://www.facebook.com/aigirl.wallpaper/', 'https://www.facebook.com/aiias/', 'https://www.facebook.com/airankingskool/', 'https://www.facebook.com/aischoolindia/', 'https://www.facebook.com/aishalmedicity/', 'https://www.facebook.com/alameenhkd/', 'https://www.facebook.com/alfatechmaduraii/', 'https://www.facebook.com/alphagened/', 'https://www.facebook.com/alphatebon/', 'https://www.facebook.com/ambusinesscentre.official/', 'https://www.facebook.com/anandfitnessvisionpune/', 'https://www.facebook.com/angelcomputereducationsurat/', 'https://www.facebook.com/anileeanimation/', 'https://www.facebook.com/antanoharini/', 'https://www.facebook.com/aonemarketingsolution/', 'https://www.facebook.com/apnaaddabarbeque.paldi/', 'https://www.facebook.com/appwarstechnologies/', 'https://www.facebook.com/aptechlearningvirar/', 'https://www.facebook.com/arkonetfoundation/', 'https://www.facebook.com/arsfintech/', 'https://www.facebook.com/artlabindiapvtltd/', 'https://www.facebook.com/asemcareerinstitute/', 'https://www.facebook.com/ashlonsolution/', 'https://www.facebook.com/ashok.prakashan/', 'https://www.facebook.com/ashokahorizons/', 'https://www.facebook.com/askgalore/', 'https://www.facebook.com/askhealthcarenallalam/', 'https://www.facebook.com/astTECS/', 'https://www.facebook.com/astechnologies.maharastra/', 'https://www.facebook.com/astrasoftwaresolutions/', 'https://www.facebook.com/astrologeravinash07/', 'https://www.facebook.com/asywealth/', 'https://www.facebook.com/atoconf/', 'https://www.facebook.com/atul.bapna.7/', 'https://www.facebook.com/automatindustries/', 'https://www.facebook.com/avivdigital/', 'https://www.facebook.com/away.education/', 'https://www.facebook.com/axisexportpestcontrol/', 'https://www.facebook.com/baiust/', 'https://www.facebook.com/balajihondacars/', 'https://www.facebook.com/bandhanbank.in/', 'https://www.facebook.com/bantigautam71/', 'https://www.facebook.com/be10x.aionline/', 'https://www.facebook.com/be10x.inonline/', 'https://www.facebook.com/be10xai/', 'https://www.facebook.com/beefashions24/', 'https://www.facebook.com/bellwayinfotechh/', 'https://www.facebook.com/bemyapp/', 'https://www.facebook.com/berlinsbi/', 'https://www.facebook.com/bestofusedbooks/', 'https://www.facebook.com/besugarfit/', 'https://www.facebook.com/bethenaturallaw/', 'https://www.facebook.com/bettershapehelp/', 'https://www.facebook.com/bewakoofcom/', 'https://www.facebook.com/bharatagritech01/', 'https://www.facebook.com/bharataxkendra/', 'https://www.facebook.com/bharatdroneassociation/', 'https://www.facebook.com/bhartivishwavidyalaya/', 'https://www.facebook.com/bhutanigroupcommercialdevelopers/', 'https://www.facebook.com/bigbyapar/', 'https://www.facebook.com/bigestate.io/', 'https://www.facebook.com/bijucapitalservices/', 'https://www.facebook.com/birthrightbyrainbow/', 'https://www.facebook.com/bizpolebusinessconsulting/', 'https://www.facebook.com/blacksuitlegal/', 'https://www.facebook.com/blazeDistanceEducation/', 'https://www.facebook.com/bloomtimelab/', 'https://www.facebook.com/blossomacademic.in/', 'https://www.facebook.com/blue.rose.publishers/', 'https://www.facebook.com/bluehomeswb/', 'https://www.facebook.com/bluelabofficial/', 'https://www.facebook.com/blueskyglobal.official/', 'https://www.facebook.com/bodyscapesgym.chd/', 'https://www.facebook.com/boithokiwb/', 'https://www.facebook.com/bol7technologies/', 'https://www.facebook.com/bollywoodtheatregroup/', 'https://www.facebook.com/bookkizee/', 'https://www.facebook.com/bookmylaundryindia/', 'https://www.facebook.com/brahmanienterpriseahm/', 'https://www.facebook.com/brainiacsapp/', 'https://www.facebook.com/branddadindia/', 'https://www.facebook.com/brandrealhyd/', 'https://www.facebook.com/bridgeonfb/', 'https://www.facebook.com/brilliantbrains.growth/', 'https://www.facebook.com/buzyprochennai/', 'https://www.facebook.com/call9009760097/', 'https://www.facebook.com/canamvirtual/', 'https://www.facebook.com/catharsissandhyaashree/', 'https://www.facebook.com/cbditsolutions/', 'https://www.facebook.com/chandigarhuniversityUP/', 'https://www.facebook.com/chargebee/', 'https://www.facebook.com/chatbotqueenmcd/', 'https://www.facebook.com/chettinaduniversityofficial/', 'https://www.facebook.com/chinaelectricalGroup/', 'https://www.facebook.com/chinamatters/', 'https://www.facebook.com/chyrenpublication/', 'https://www.facebook.com/cinutedigital/', 'https://www.facebook.com/claimslogisticsacademy/', 'https://www.facebook.com/clevergenz/', 'https://www.facebook.com/clickupprojectmanagement/', 'https://www.facebook.com/cmddevelopers/', 'https://www.facebook.com/coachkailashpinjani/', 'https://www.facebook.com/coachlifesports/', 'https://www.facebook.com/coachmelaniebenson/', 'https://www.facebook.com/commongroundhealthcare/', 'https://www.facebook.com/comparevidya/', 'https://www.facebook.com/compoundingbulls/', 'https://www.facebook.com/crackacademyofficial.in/', 'https://www.facebook.com/craftnotionbusiness/', 'https://www.facebook.com/createbytes/', 'https://www.facebook.com/cripumps/', 'https://www.facebook.com/cspkart/', 'https://www.facebook.com/customdesign970/', 'https://www.facebook.com/cuteowledu/', 'https://www.facebook.com/cyberadvancesolutionspvtltd/', 'https://www.facebook.com/cyberbureautg/', 'https://www.facebook.com/cybertechdefender/', 'https://www.facebook.com/dahiyaconsulting/', 'https://www.facebook.com/dakinitranslations/', 'https://www.facebook.com/databricksinc/', 'https://www.facebook.com/datadoghq/', 'https://www.facebook.com/datasysinventure/', 'https://www.facebook.com/dealmirror/', 'https://www.facebook.com/delhipublicschoolanand/', 'https://www.facebook.com/demanzomarketing/', 'https://www.facebook.com/deropoinfotech/', 'https://www.facebook.com/deshbhagatuniversitypunjab/', 'https://www.facebook.com/designhost01/', 'https://www.facebook.com/dextratechnologies2014/', 'https://www.facebook.com/dhananyarentattire/', 'https://www.facebook.com/dhanvijay/', 'https://www.facebook.com/dhruvcyberworld/', 'https://www.facebook.com/diginerve.jaypee/', 'https://www.facebook.com/digitalempireathome/', 'https://www.facebook.com/digitalempires.co/', 'https://www.facebook.com/digitalmarketingbalaji/', 'https://www.facebook.com/digitalpitch.in/', 'https://www.facebook.com/digitalplannerxboutique/', 'https://www.facebook.com/digitalpoonamindia/', 'https://www.facebook.com/digitalpratik/', 'https://www.facebook.com/digitalprismaIN/', 'https://www.facebook.com/digitalraiz/', 'https://www.facebook.com/digitalsandipacademy/', 'https://www.facebook.com/digitaltechnica/', 'https://www.facebook.com/digitalveterinary/', 'https://www.facebook.com/digitroverts/', 'https://www.facebook.com/discountbuddyy/', 'https://www.facebook.com/dishalivegroup/', 'https://www.facebook.com/dlpafricamarketing/', 'https://www.facebook.com/docslegal.in/', 'https://www.facebook.com/dolphyindia/', 'https://www.facebook.com/dreamteamindia/', 'https://www.facebook.com/dreamvillas25/', 'https://www.facebook.com/drerpai/', 'https://www.facebook.com/dronetv.in/', 'https://www.facebook.com/drpranavsharmaMS/', 'https://www.facebook.com/drvijaydahiphale/', 'https://www.facebook.com/dspeedup/', 'https://www.facebook.com/dularohealthyindia/', 'https://www.facebook.com/eTraday/', 'https://www.facebook.com/earneysolutions/', 'https://www.facebook.com/easyadswithadoll/', 'https://www.facebook.com/easypms365/', 'https://www.facebook.com/easyreports/', 'https://www.facebook.com/easysocial.io/', 'https://www.facebook.com/ecare.upskill/', 'https://www.facebook.com/ecololover/', 'https://www.facebook.com/edYoda.here/', 'https://www.facebook.com/edexelearning/', 'https://www.facebook.com/edlerhub/', 'https://www.facebook.com/edrootslive/', 'https://www.facebook.com/eisolutions.kollam/', 'https://www.facebook.com/ekacareHQ/', 'https://www.facebook.com/elegantuae/', 'https://www.facebook.com/elements47naturehomes/', 'https://www.facebook.com/elevatesheets/', 'https://www.facebook.com/eliteguwahati/', 'https://www.facebook.com/embarcaderotech/', 'https://www.facebook.com/emperorofblues/', 'https://www.facebook.com/enarkuplift/', 'https://www.facebook.com/engagenext.in/', 'https://www.facebook.com/englishwiseamritsarindia/', 'https://www.facebook.com/esgroupofinstitutions/', 'https://www.facebook.com/euphoriahomesofficial/', 'https://www.facebook.com/evangelistfranklinjoshua/', 'https://www.facebook.com/eveITIndia/', 'https://www.facebook.com/evenstorindia/', 'https://www.facebook.com/events/1318117115958651/', 'https://www.facebook.com/events/1380490542949465', 'https://www.facebook.com/events/1741457676405013/', 'https://www.facebook.com/events/1929452424537728', 'https://www.facebook.com/events/550099451456403', 'https://www.facebook.com/events/658888660185049', 'https://www.facebook.com/evereststabilizersprivatelimited/', 'https://www.facebook.com/evianworld/', 'https://www.facebook.com/ewaplans/', 'https://www.facebook.com/execedISB/', 'https://www.facebook.com/expanderp/', 'https://www.facebook.com/facestoriesbyvarsha/', 'https://www.facebook.com/faceup/', 'https://www.facebook.com/factohr/', 'https://www.facebook.com/fame2fame/', 'https://www.facebook.com/financemanagements/', 'https://www.facebook.com/financialkundali/', 'https://www.facebook.com/finout.io/', 'https://www.facebook.com/fitnessfactorygoa/', 'https://www.facebook.com/fiverrgigspromotion2018/', 'https://www.facebook.com/flabs.in/', 'https://www.facebook.com/flame.mohali/', 'https://www.facebook.com/fletcheronline/', 'https://www.facebook.com/foodtalkindia/', 'https://www.facebook.com/forensicinvestigationsnoida/', 'https://www.facebook.com/fortuneacademy.me/', 'https://www.facebook.com/franchiseinsider/', 'https://www.facebook.com/franchisenationss/', 'https://www.facebook.com/futuredreamuae/', 'https://www.facebook.com/futureschoolin/', 'https://www.facebook.com/gahiragro/', 'https://www.facebook.com/gauravaroracoach/', 'https://www.facebook.com/gccigate/', 'https://www.facebook.com/gci.srdr/', 'https://www.facebook.com/gdagclasses/', 'https://www.facebook.com/gdwaterconsult1/', 'https://www.facebook.com/geolifeagritech/', 'https://www.facebook.com/getmentore/', 'https://www.facebook.com/ghlvideo/', 'https://www.facebook.com/globalenergysol/', 'https://www.facebook.com/globalitcomputerclassacademy/', 'https://www.facebook.com/gnetcomputer.salempur/', 'https://www.facebook.com/goalinstituteofficial/', 'https://www.facebook.com/goalippo/', 'https://www.facebook.com/gocom.gocomai/', 'https://www.facebook.com/goldconf/', 'https://www.facebook.com/gopanear/', 'https://www.facebook.com/goshizzy/', 'https://www.facebook.com/gravity4apps/', 'https://www.facebook.com/greenportfolioco/', 'https://www.facebook.com/greensoftb/', 'https://www.facebook.com/groups/1098854286810396/', 'https://www.facebook.com/growcify/', 'https://www.facebook.com/growmeorganic/', 'https://www.facebook.com/growthaspire/', 'https://www.facebook.com/gtecknr/', 'https://www.facebook.com/gtecthirumala/', 'https://www.facebook.com/gtracademy.edu/', 'https://www.facebook.com/guardiansedtech/', 'https://www.facebook.com/guinstituteofict/', 'https://www.facebook.com/gulenoor.mazumder/', 'https://www.facebook.com/gyanvidigital/', 'https://www.facebook.com/hakkodaglobal/', 'https://www.facebook.com/harvishah.fashionbusinesscoach/', 'https://www.facebook.com/hcltechgermany/', 'https://www.facebook.com/healingkneeandspine/', 'https://www.facebook.com/healwithdivinelight/', 'https://www.facebook.com/help/396404120401278/list', 'https://www.facebook.com/help/980264326141711', 'https://www.facebook.com/help/contact/777819979008267', 'https://www.facebook.com/heycoach.in/', 'https://www.facebook.com/heyyabbas/', 'https://www.facebook.com/hiimsofficial', 'https://www.facebook.com/hiimsofficial/', 'https://www.facebook.com/holosoft.llc/', 'https://www.facebook.com/howsweetjaipur/']

phone_list = set()
chunk_size = 100
semaphore = asyncio.Semaphore(8)

# Load existing numbers from CSV to prevent duplicates
if os.path.exists("phones.csv"):
    with open("phones.csv", newline="") as f:
        reader = csv.reader(f)
        phone_list.update(row[0] for row in reader)

async def process_url(browser, url):
    async with semaphore:
        page = await browser.new_page()
        try:
            await page.goto(url)
            try:
                await page.click("div[aria-label='Close']", timeout=3000)
            except:
                pass
            await page.wait_for_selector("div[role='main']")
            await page.wait_for_timeout(3000)
            phone_element = page.locator("text=/\\+?[0-9][0-9\\-\\s]{8,}/").first
            if await phone_element.count() > 0:
                raw = await phone_element.inner_text()
                cleaned = raw.replace(" ", "")
                if cleaned not in phone_list:
                    phone_list.add(cleaned)
                    with open("phones.csv", "a", newline="") as f:
                        writer = csv.writer(f)
                        writer.writerow([cleaned])
        except:
            pass
        finally:
            await page.close()
            LIST.remove(url)

async def go():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        tasks = [process_url(browser, url) for url in LIST[:chunk_size]]
        await asyncio.gather(*tasks)
        await browser.close()

asyncio.run(go())
